

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basic Usage &mdash; Typhon 0.2.0rc1+9.ge96d698 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Application Connections" href="connections.html" />
    <link rel="prev" title="Typhon" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Typhon
          

          
          </a>

          
            
            
              <div class="version">
                0.2.0rc1+9.ge96d698
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorial</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#display-creation">Display Creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-stylesheet">Using the StyleSheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#making-modifications">Making Modifications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="connections.html">Application Connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_methods.html">Including Python Code</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="display.html">Display Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="widgets.html">Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Typhon Plugins</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Typhon</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Basic Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/basic_usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="basic-usage">
<h1>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h1>
<p>An overview of the basic use cases of Typhon</p>
<div class="section" id="display-creation">
<h2>Display Creation<a class="headerlink" href="#display-creation" title="Permalink to this headline">¶</a></h2>
<p>Typhon interprets the internal structure of the <code class="docutils literal notranslate"><span class="pre">ophyd.Device</span></code> to create the
<cite>PyDM</cite> user interface, so the most intuitive way to configure the created
display is to include things in the device itself. This also has the advantage
of keeping your Python API and display in sync, making the transition from
using screens to using an IPython shell seamless.</p>
<p>Take for instance the built-in <code class="docutils literal notranslate"><span class="pre">ophyd.EpicsMotor</span></code> class, we can do a quick
survey of what the default <code class="docutils literal notranslate"><span class="pre">read</span></code> and <code class="docutils literal notranslate"><span class="pre">configuration</span></code> attributes are:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">ophyd</span>

<span class="gp">In [2]: </span><span class="n">ophyd</span><span class="o">.</span><span class="n">EpicsMotor</span><span class="o">.</span><span class="n">_default_read_attrs</span>

<span class="gp">In [3]: </span><span class="n">ophyd</span><span class="o">.</span><span class="n">EpicsMotor</span><span class="o">.</span><span class="n">_default_configuration_attrs</span>
</pre></div>
</div>
<p>These <code class="docutils literal notranslate"><span class="pre">read</span></code> and <code class="docutils literal notranslate"><span class="pre">configuration</span></code> attributes can always be changed when the
device is instantiated.  However, this is only a small subset of the signals
that are associated with the class.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">ophyd</span><span class="o">.</span><span class="n">EpicsMotor</span><span class="o">.</span><span class="n">_sig_attrs</span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">OrderedDict([(&#39;user_readback&#39;, Component(EpicsSignalRO, &#39;.RBV&#39;, kind=5)),</span>
<span class="go">             (&#39;user_setpoint&#39;,</span>
<span class="go">              Component(EpicsSignal, &#39;.VAL&#39;, limits=True, kind=1)),</span>
<span class="go">             (&#39;user_offset&#39;, Component(EpicsSignal, &#39;.OFF&#39;, kind=2)),</span>
<span class="go">             (&#39;user_offset_dir&#39;, Component(EpicsSignal, &#39;.DIR&#39;, kind=2)),</span>
<span class="go">             (&#39;offset_freeze_switch&#39;, Component(EpicsSignal, &#39;.FOFF&#39;, kind=0)),</span>
<span class="go">             (&#39;set_use_switch&#39;, Component(EpicsSignal, &#39;.SET&#39;, kind=0)),</span>
<span class="go">             (&#39;velocity&#39;, Component(EpicsSignal, &#39;.VELO&#39;, kind=2)),</span>
<span class="go">             (&#39;acceleration&#39;, Component(EpicsSignal, &#39;.ACCL&#39;, kind=2)),</span>
<span class="go">             (&#39;motor_egu&#39;, Component(EpicsSignal, &#39;.EGU&#39;, kind=2)),</span>
<span class="go">             (&#39;motor_is_moving&#39;, Component(EpicsSignalRO, &#39;.MOVN&#39;, kind=0)),</span>
<span class="go">             (&#39;motor_done_move&#39;, Component(EpicsSignalRO, &#39;.DMOV&#39;, kind=0)),</span>
<span class="go">             (&#39;high_limit_switch&#39;, Component(EpicsSignal, &#39;.HLS&#39;, kind=0)),</span>
<span class="go">             (&#39;low_limit_switch&#39;, Component(EpicsSignal, &#39;.LLS&#39;, kind=0)),</span>
<span class="go">             (&#39;direction_of_travel&#39;, Component(EpicsSignal, &#39;.TDIR&#39;, kind=0)),</span>
<span class="go">             (&#39;motor_stop&#39;, Component(EpicsSignal, &#39;.STOP&#39;, kind=0)),</span>
<span class="go">             (&#39;home_forward&#39;, Component(EpicsSignal, &#39;.HOMF&#39;, kind=0)),</span>
<span class="go">             (&#39;home_reverse&#39;, Component(EpicsSignal, &#39;.HOMR&#39;, kind=0))])</span>
</pre></div>
</div>
<p>Now, at first glance it may not be obvious, but there is a lot of information
here! We have a Python abstraction capable of instantiating a number of useful
EPICS signals based on a given <code class="docutils literal notranslate"><span class="pre">prefix</span></code>. We know which of these signals an
operator will want to control and which ones are purely meant to be read back.
We also have these signals grouped by their importance to operation, each with
a terse human legible description of what the PV represents.</p>
<p>Typhon takes advantage of this to generate a concise PyDM user display. The
<a class="reference internal" href="display.html#typhon.DeviceDisplay" title="typhon.DeviceDisplay"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeviceDisplay</span></code></a> uses the signal groups; <code class="docutils literal notranslate"><span class="pre">read_attrs</span></code>,
<code class="docutils literal notranslate"><span class="pre">configuration_attrs</span></code> and <code class="docutils literal notranslate"><span class="pre">hints</span></code> to generate plots and widgets based on
the type and class of EPICSSignals. In order to best select the widget types,
<a class="reference internal" href="display.html#typhon.DeviceDisplay" title="typhon.DeviceDisplay"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeviceDisplay</span></code></a> attempts to connect to all of the PVs listed. If this
is not possible, there are ways to manually configure which widget will be
used. Simply invoke your device and then create your <code class="docutils literal notranslate"><span class="pre">PyDMApplication</span></code> and
widget</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pydm</span>

<span class="kn">from</span> <span class="nn">typhon</span> <span class="k">import</span> <span class="n">DeviceDisplay</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">pydm</span><span class="o">.</span><span class="n">PyDMApplication</span><span class="p">()</span>

<span class="n">dg1_m1</span> <span class="o">=</span> <span class="n">EpicsMotor</span><span class="p">(</span><span class="s1">&#39;MFX:DG1:MMS:01&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DG1 M1&quot;</span><span class="p">)</span>

<span class="n">typhon_display</span> <span class="o">=</span> <span class="n">DeviceDisplay</span><span class="p">(</span><span class="n">dg1_m1</span><span class="p">)</span>

<span class="n">typhon_display</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</pre></div>
</div>
<p>Typhon also watches for trees of devices, for instance, if we wanted to
represent a stack of three EPICS motors as a single object.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ophyd</span> <span class="k">import</span> <span class="n">EpicsMotor</span><span class="p">,</span> <span class="n">Device</span><span class="p">,</span> <span class="n">Component</span> <span class="k">as</span> <span class="n">C</span>

<span class="k">class</span> <span class="nc">XYZStage</span><span class="p">(</span><span class="n">Device</span><span class="p">):</span>

     <span class="c1"># Define three separate motor axes</span>
     <span class="n">x</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">EpicsMotor</span><span class="p">,</span> <span class="s2">&quot;:MMS:01&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span> <span class="s1">&#39;X Positioner&#39;</span><span class="p">)</span>
     <span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">EpicsMotor</span><span class="p">,</span> <span class="s2">&quot;:MMS:02&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span> <span class="s1">&#39;Y Positioner&#39;</span><span class="p">)</span>
     <span class="n">z</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">EpicsMotor</span><span class="p">,</span> <span class="s2">&quot;:MMS:03&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span> <span class="s1">&#39;Z Positioner&#39;</span><span class="p">)</span>

     <span class="c1"># Define basic read attributes</span>
     <span class="n">_default_read_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x.user_readback&#39;</span><span class="p">,</span> <span class="s1">&#39;y.user_readback&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;z.user_readback&#39;</span><span class="p">,</span> <span class="s1">&#39;x.user_setpoint&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;y.user_setpoint&#39;</span><span class="p">,</span> <span class="s1">&#39;z.user_setpoint&#39;</span><span class="p">]</span>

     <span class="nd">@property</span>
     <span class="k">def</span> <span class="nf">hints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;x.readback&#39;</span><span class="p">,</span> <span class="s1">&#39;y.readback&#39;</span><span class="p">,</span> <span class="s1">&#39;z.readback&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Typhon will show the top level features of the class, but still allow the
operator to view lower level details as they see fit. This allows for the
representation of complex devices with nested structures in clean consistent
user displays.</p>
</div>
<div class="section" id="using-the-stylesheet">
<h2>Using the StyleSheet<a class="headerlink" href="#using-the-stylesheet" title="Permalink to this headline">¶</a></h2>
<p>While it is no means a requirement, Typhon ships with a custom stylesheet to
improve the look of the widgets. By default this isn’t activated, but can be
configured with <cite>:func:</cite>.use_stylesheet`</p>
</div>
<div class="section" id="making-modifications">
<h2>Making Modifications<a class="headerlink" href="#making-modifications" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="connections.html" class="btn btn-neutral float-right" title="Application Connections" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Typhon" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, SLAC National Accelerator Laboratory.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.0rc1+9.ge96d698',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>